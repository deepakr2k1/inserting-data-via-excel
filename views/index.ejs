<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <title>Add from Excel</title>
    <link rel="stylesheet" href="index.css">

</head>

<body>

    <h3>Add Candidates to Database</h3>
    <form class="boundary" action="/upload" method="POST" encType="multipart/form-data">
        <% if(msg == 'none') { %>
            <input type="file" name="upload_file" id="file" />
            <label for="file">
                <svg id="upload_icon" xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-arrow-up-circle" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-7.5 3.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V11.5z"/>
                </svg>
            </label>
            <p id="msg">Upload a .xlsx or .xls file here</p>
            <div>
                <input id="button" type="submit">
            </div>
            <% } else if(msg == 'success') {%>
                <h4 id="success">Thank You!</h4>
                <div>
                    <span>
                        <svg id="success_icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-check-circle" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                            <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                        </svg>
                    </span>
                    <span>File Successfully Uploaded</span>
                </div>
                <span>Your records will be processed shortly.</span>
                <% } else { %>
                    <h4 id="failed" ">ERROR!</h4>
                    <h5>Something went wrong</h5>
                    <h5>Please Try again</h5>
                    <% } %>
    </form>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js " integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf " crossorigin="anonymous "></script>
    <script>
        var input = document.getElementById('file');
        var msg = document.getElementById('msg');
        var btn = document.getElementById('button');

        input.addEventListener('change', showFileName);

        function showFileName(event) {
            var input = event.srcElement;
            var fileName = input.files[0].name;
            var ext = fileName.split('.').pop();
            console.log(ext)
            console.log(btn)
            if (ext+" " != "xlsx " && ext+" " != "xls ") {
                msg.textContent = "Oops! invalid file format ";
                msg.style.color = "red ";
                btn.style.display = "none ";
            } else {
                msg.textContent = fileName;
                btn.style.display = "inline-block ";
                msg.style.color = "black ";
            };
        }
    </script>
</body>

</html>